<div fxLayout="column" fxLayoutAlign="stretch center">
  <mat-card class="mat-elevation-z6">
    <mat-card-title fxLayoutAlign="center" i18n>
      培训记录填报
    </mat-card-title>
    <mat-card-subtitle fxLayoutAlign="center" i18n>
      此表单只能填写提交教师参加校外培训的记录,校内培训记录将由组织培训的部门进行录入。
    </mat-card-subtitle>
    <mat-card-content>
      <form class="form-container" (ngSubmit)="onSubmit()" [formGroup]="recordForm" fxLayout="column">
        <mat-form-field appearance="outline">
          <mat-icon matPrefix>note_add</mat-icon>
          <mat-label i18n>培训名称</mat-label>
          <input matInput type="text" placeholder="请告诉我们您所参加培训的名称" formControlName="name" i18n-placeholder required>
          <mat-error *ngIf="name.invalid && (name.dirty || name.touched)">
            <span *ngIf="!!name.errors.required" i18n>
              您需要提供所参加培训的名称。
            </span>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>calendar_today</mat-icon>
          <mat-label i18n>参加时间</mat-label>
          <input matInput [matDatepicker]="picker" placeholder="请告诉我们您所参加培训的时间" formControlName="time" i18n-placeholder
            required>
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker touchUi #picker disabled="false"></mat-datepicker>
          <mat-error *ngIf="time.invalid && (time.dirty || time.touched)">
            <span *ngIf="!!time.errors.required" i18n>
              您需要提供您所参加培训的时间。
            </span>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>place</mat-icon>
          <mat-label i18n>参加地点</mat-label>
          <input matInput type="text" placeholder="请告诉我们您所参加培训的地点" formControlName="location" i18n-placeholder required>
          <mat-error *ngIf="location.invalid && (location.dirty || location.touched)">
            <span *ngIf="!!location.errors.required" i18n>
              您需要提供您所参加培训的地点。
            </span>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>access_time</mat-icon>
          <mat-label i18n>参加学时</mat-label>
          <input matInput type="number" placeholder="请告诉我们您所参加培训的时长" formControlName="num_hours" i18n-placeholder
            required>
          <mat-error *ngIf="numHours.invalid && (numHours.dirty || numHours.touched)">
            <span *ngIf="!!numHours.errors.required" i18n>
              您需要提供您所参加培训的时长。
            </span>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>people</mat-icon>
          <mat-label i18n>参加人数</mat-label>
          <input matInput type="number" placeholder="请告诉我们您所参加培训的参加人数" formControlName="num_participants"
            i18n-placeholder required>
          <mat-error *ngIf="numParticipants.invalid && (numParticipants.dirty || numParticipants.touched)">
            <span *ngIf="!!numParticipants.errors.required" i18n>
              您需要提供您所参加培训的参加人数。
            </span>
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>assignment</mat-icon>
          <mat-label i18n>培训内容</mat-label>
          <textarea matInput placeholder="请告诉我们您所参加培训的培训内容，您也可以通过上传附件的形式提交该部分内容" formControlName="content"
            i18n-placeholder></textarea>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>assignment</mat-icon>
          <mat-label i18n>培训总结</mat-label>
          <textarea matInput placeholder="请告诉我们您对本次培训的总结，您也可以通过上传附件的形式提交该部分内容" formControlName="summary"
            i18n-placeholder></textarea>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-icon matPrefix>assignment</mat-icon>
          <mat-label i18n>培训反馈</mat-label>
          <textarea matInput placeholder="请告诉我们您对本次培训的一些意见，您也可以通过上传附件的形式提交该部分内容" formControlName="feedback"
            i18n-placeholder></textarea>
        </mat-form-field>

        <div formArrayName="files">
          <h3>
            <span i18n>附件</span>
            <button mat-button type="button" color="primary" (click)="addFile()" i18n>添加新附件</button>
          </h3>

          <div *ngFor="let file of files.controls; let i=index">
            <label><span i18n>文件名:</span>{{ file.value }}</label>
            <input hidden type="file" #uploadFileInput (change)="onFileAdd($event)" [formControlName]="i" />
            <button mat-button type="button" *ngIf="!file.value" (click)="uploadFileInput.click()" i18n>选择附件</button>
            <button mat-button type="button" color="warn" *ngIf="file.value" (click)="onFileRemove(i)" i18n>删除附件</button>
          </div>
        </div>

        <button mat-raised-button type="submit" color="primary" [disabled]="recordForm.invalid" i18n>提交</button>
      </form>
    </mat-card-content>
  </mat-card>
</div>